function U = AME46
% ------------------------------------------------------------------------------
%
%       2020-09-02 first release of AME(4, 6) in analytical form
%       2023-03-07 last update
%
%       Suhail Ahmad Rather
%       Adam Burchardt
%       Wojciech Bruzda
%       Grzegorz Rajchel-Mieldzioc
%       Arul Lakshminarayan
%       Karol Zyczkowski
%
%       Phys. Rev. Lett. 128, 080507 (2022)
%       https://doi.org/10.1103/PhysRevLett.128.080507
%       https://arxiv.org/abs/2104.05122
%
%       see also:
%       J. Phys.: Conf. Ser. 2448, 012003 (2023)
%       https://doi.org/10.1088/1742-6596/2448/1/012003
%
% ------------------------------------------------------------------------------
%
% Function AME46 returns a unitary matrix U of order 36 such that
% svd(U) = svd(U^R) = svd(U^G) = [1 1 1 ... 1] = vector of 36 ones
% where ^R := reshuffling
%       ^G := partial transpose (w.r.t. 2^nd subsystem)
%
% In other words,
% it returns a complex 2-unitary representation of the AME(4, 6) state.
%
% ------------------------------------------------------------------------------
% Call:
% >> U = AME46;
%
% Technically: U = (B1 (+) B2 (+) B3) * P36(3)^T;
% Hence, the very same permutation matrix that was used as a sort of "starting"
% point, P = P36(3) [by Clarisse et al.], can be used to encode AME(4, 6) into
% a nice block diagonal form.
% ------------------------------------------------------------------------------

    a = sqrt(1 - 1 / sqrt(5)) / 2; % = 1 / sqrt(5 + sqrt(5));
    b = sqrt(1 + 1 / sqrt(5)) / 2; % = sqrt((5 + sqrt(5)) / 20);
    c = 1 / sqrt(2);
    w = exp(2j * pi / 20);

    B1 = [... % block #1
        0  0  b  0  0  0  a  0  0  0  0  c;... % amplitudes
        0  b  0  0  0  0  0  c  a  0  0  0;...
        0  0  0  b  b  0  0  0  0  a  a  0;...
        0  0  0  a  a  0  0  0  0  b  b  0;...
        0  a  0  0  0  c  0  0  b  0  0  0;...
        c  0  a  0  0  0  b  0  0  0  0  0;...
        c  0  a  0  0  0  b  0  0  0  0  0;...
        0  a  0  0  0  c  0  0  b  0  0  0;...
        0  0  0  a  a  0  0  0  0  b  b  0;...
        0  0  0  b  b  0  0  0  0  a  a  0;...
        0  b  0  0  0  0  0  c  a  0  0  0;...
        0  0  b  0  0  0  a  0  0  0  0  c;...
    ] .* w.^[
        0  0 19  0  0  0 18  0  0  0  0  6;... % phases
        0  9  0  0  0  0  0  3  0  0  0  0;...
        0  0  0  7 15  0  0  0  0 13 14  0;...
        0  0  0  2 14  0  0  0  0  2 19  0;...
        0  5  0  0  0 19  0  0  6  0  0  0;...
       19  0 17  0  0  0  6  0  0  0  0  0;...
        0  0  8  0  0  0 17  0  0  0  0  0;...
        0  6  0  0  0 10  0  0  7  0  0  0;...
        0  0  0 16 12  0  0  0  0 12  1  0;...
        0  0  0  1  1  0  0  0  0 11 16  0;...
        0 12  0  0  0  0  0 16  3  0  0  0;...
        0  0 16  0  0  0 15  0  0  0  0 13;...
    ];

    B2 = [... % block #2
        0  0  a  0  0  0  0  c  b  0  0  0;... % amplitudes
        a  0  0  0  b  c  0  0  0  0  0  0;...
        0  0  0  c  0  0  0  0  0  a  0  b;...
        0  0  0  0  0  0  c  0  0  b  0  a;...
        b  c  0  0  a  0  0  0  0  0  0  0;...
        0  0  b  0  0  0  0  0  a  0  c  0;...
        0  0  b  0  0  0  0  0  a  0  c  0;...
        b  c  0  0  a  0  0  0  0  0  0  0;...
        0  0  0  0  0  0  c  0  0  b  0  a;...
        0  0  0  c  0  0  0  0  0  a  0  b;...
        a  0  0  0  b  c  0  0  0  0  0  0;...
        0  0  a  0  0  0  0  c  b  0  0  0;...
    ] .* w.^ [
        0  0  0  0  0  0  0 13 16  0  0  0;... % phases
       18  0  0  0  1 14  0  0  0  0  0  0;...
        0  0  0 15  0  0  0  0  0  1  0  3;...
        0  0  0  0  0  0 18  0  0  2  0 14;...
        8 14  0  0  1  0  0  0  0  0  0  0;...
        0  0  0  0  0  0  0  0  6  0  0  0;...
        0  0 11  0  0  0  0  0 17  0  1  0;...
        1 17  0  0 14  0  0  0  0  0  0  0;...
        0  0  0  0  0  0  6  0  0  0  0 12;...
        0  0  0 15  0  0  0  0  0 11  0 13;...
        1  0  0  0  4  7  0  0  0  0  0  0;...
        0  0  1  0  0  0  0  4 17  0  0  0;...
    ];

    B3 = [... % block 3
        a  0  0  0  0  0  c  0  0  b  0  0;... % amplitudes
        0  0  c  0  0  0  0  a  0  0  0  b;...
        0  a  0  0  b  0  0  0  c  0  0  0;...
        0  b  0  0  a  0  0  0  0  0  c  0;...
        0  0  0  0  0  c  0  b  0  0  0  a;...
        b  0  0  c  0  0  0  0  0  a  0  0;...
        b  0  0  c  0  0  0  0  0  a  0  0;...
        0  0  0  0  0  c  0  b  0  0  0  a;...
        0  b  0  0  a  0  0  0  0  0  c  0;...
        0  a  0  0  b  0  0  0  c  0  0  0;...
        0  0  c  0  0  0  0  a  0  0  0  b;...
        a  0  0  0  0  0  c  0  0  b  0  0;...
    ] .* w.^ [
        4  0  0  0  0  0  8  0  0 14  0  0;... % phases
        0  0 14  0  0  0  0  6  0  0  0 17;...
        0  6  0  0 16  0  0  0  0  0  0  0;...
        0 19  0  0 19  0  0  0  0  0 15  0;...
        0  0  0  0  0  1  0  8  0  0  0  9;...
        0  0  0 14  0  0  0  0  0  0  0  0;...
        2  0  0  6  0  0  0  0  0  2  0  0;...
        0  0  0  0  0 19  0 16  0  0  0 17;...
        0 12  0  0 12  0  0  0  0  0 18  0;...
        0 15  0  0  5  0  0  0 19  0  0  0;...
        0  0  6  0  0  0  0  8  0  0  0 19;...
        8  0  0  0  0  0  2  0  0 18  0  0;...
    ];

    U = zeros(36);
    U( 1:12,  1:12) = B1;
    U(13:24, 13:24) = B2;
    U(25:36, 25:36) = B3;

    U = U * transpose(P36(3));

end

